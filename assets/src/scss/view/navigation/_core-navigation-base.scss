/* ==========================================================================
   BlockWind SCSS: Navigation (Core Mobile Modal Behavior)
   --------------------------------------------------------------------------
   Role: Base behavior + ergonomics for the core Navigation block when the
         responsive (modal) menu is open.
   Scope:
   - No wrapper assumptions (no .site-nav required).
   - Scoped to the open responsive container state only, to avoid impacting
     desktop dropdown behavior.
   What this file does:
   - Submenu visibility is driven by aria-expanded (accessibility-aligned).
   - Mobile tap targets reserve space for the submenu toggle hit area.
   - Focus-visible rings are applied using theme.json focus tokens.
   ========================================================================== */

@use "../../tokens" as t;

/* Open responsive (modal) menu state.
   WordPress commonly toggles :root.has-modal-open + .is-menu-open. */
:root.has-modal-open .wp-block-navigation__responsive-container.is-menu-open {

  /* ------------------------------------------------------------------------
     Optional 4: Submenu show/hide driven by aria-expanded
     --------------------------------------------------------------------- */

  .wp-block-navigation .has-child .wp-block-navigation__submenu-container {
    display: none;
  }

  .wp-block-navigation-submenu__toggle[aria-expanded="true"]
    ~ .wp-block-navigation__submenu-container {
    display: flex;
  }

  /* Mobile submenu layout (minimal, ergonomic) */
  .wp-block-navigation__submenu-container {
    flex-direction: column;
    align-items: flex-start;
    width: 100%;
    gap: t.$bw-nav-mobile-submenu-gap;
    padding-top: t.$bw-nav-mobile-submenu-padding-top;
    padding-left: t.$bw-nav-mobile-submenu-indent;
  }

  /* ------------------------------------------------------------------------
     Mobile tap targets + submenu toggle hit area
     --------------------------------------------------------------------- */

  /* Make navigation items full-width and position a toggle hit area. */
  li.wp-block-navigation-item,
  .wp-block-page-list li {
    width: 100%;
    position: relative;
  }

  /* Links become full-width tap targets, reserving space for the toggle. */
  .wp-block-navigation-item__content {
    display: block;
    width: 100%;
    padding: t.$bw-nav-item-py t.$bw-nav-mobile-hit-area t.$bw-nav-item-py t.$bw-nav-item-px;
    text-decoration: inherit;
  }

  /* Submenu toggle button: large hit area, pinned to the edge. */
  .wp-block-navigation-submenu__toggle {
    position: absolute;
    top: 0;
    right: 0;
    width: t.$bw-nav-mobile-hit-area;
    height: 100%;
    padding: t.$bw-nav-item-py 0;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
    background: transparent;
  }

  /* ------------------------------------------------------------------------
     Optional 5: Focus-visible rings (token-driven)
     --------------------------------------------------------------------- */

  .wp-block-navigation-item__content:focus-visible,
  .wp-block-navigation-submenu__toggle:focus-visible,
  .wp-block-navigation__responsive-container-open:focus-visible,
  .wp-block-navigation__responsive-container-close:focus-visible {
    outline: t.$bw-focus-ring-width solid t.$bw-focus-ring-color;
    outline-offset: t.$bw-focus-ring-offset;
    border-radius: t.$bw-focus-ring-radius;
  }
}

/* RTL adjustments (must be scoped with :root as the ancestor of body) */
:root.has-modal-open body.rtl .wp-block-navigation__responsive-container.is-menu-open {
  .wp-block-navigation__submenu-container {
    padding-left: 0;
    padding-right: t.$bw-nav-mobile-submenu-indent;
  }

  .wp-block-navigation-item__content {
    padding: t.$bw-nav-item-py t.$bw-nav-item-px t.$bw-nav-item-py t.$bw-nav-mobile-hit-area;
  }

  .wp-block-navigation-submenu__toggle {
    right: auto;
    left: 0;
  }
}
